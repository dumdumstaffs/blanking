(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{7649:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/documents/upload",function(){return t(3178)}])},4405:function(e,n,t){"use strict";t.d(n,{xl:function(){return p},rg:function(){return f}});var r=t(8788),u=t(5163),s=t(7079);function i(e){return c.apply(this,arguments)}function c(){return(c=(0,r.Z)(function(e){var n,t,r;return(0,u.__generator)(this,function(r){switch(r.label){case 0:return n=e.accountId,t=e.dto,[4,s.dJ.post("/documents/".concat(n),t)];case 1:return[2,r.sent().data]}})})).apply(this,arguments)}function o(){return(o=(0,r.Z)(function(e){var n,t;return(0,u.__generator)(this,function(t){switch(t.label){case 0:return n=e.accountId,[4,s.dJ.get("/admin/documents/".concat(n))];case 1:return[2,t.sent().data]}})})).apply(this,arguments)}var a=t(5148),l=t(2066),d=t(8983),f=function(){var e=(0,l.useQueryClient)();return(0,l.useMutation)(i,{onSuccess:function(n,t){var r=t.accountId;return e.invalidateQueries(d.eA.get(r))}})},m=(0,a.no)("adminDocuments",{for:function(e){return[e]}}),p=function(e){return(0,l.useQuery)(m.for(e),function(){return function(e){return o.apply(this,arguments)}({accountId:e})})}},3178:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return y}});var r=t(8788),u=t(865),s=t(5163),i=t(2322),c=t(4405),o=t(5133),a=t(412),l=t(9447),d=t(4819),f=t(385),m=t(8720),p=t(8295),h=t(9644),v=t.n(h),x=t(5632),j=t(3955),_=t(2202);function y(){return(0,i.jsx)(f.c,{children:(0,i.jsx)(f.c.User,{children:(0,i.jsx)(m.wy,{children:function(e){var n,t,r=e.account;return(null===(n=r.documentRequest)||void 0===n?void 0:n.status)==="idle"||(null===(t=r.documentRequest)||void 0===t?void 0:t.status)==="rejected"?(0,i.jsxs)(l.$,{children:[(0,i.jsx)(l.$.Title,{children:(0,i.jsx)("h3",{children:"Upload Document"})}),(0,i.jsxs)(l.$.Content,{className:"py-6",children:[(0,i.jsx)("div",{className:"flex justify-between items-baseline",children:(0,i.jsx)("h4",{className:"text-lg font-medium",children:r.documentRequest.name})}),(0,i.jsx)("p",{className:"mt-2",children:r.documentRequest.desc}),(0,i.jsx)(g,{})]})]}):(0,i.jsx)(o.l,{path:"/"})}})})})}function g(){var e,n=(0,x.useRouter)(),t=(0,m.Mq)().account,o=(0,j.cI)(),l=(0,c.rg)(),f=o.handleSubmit((e=(0,r.Z)(function(e){var r,u,i;return(0,s.__generator)(this,function(s){switch(s.label){case 0:if(r=e.file,!t.documentRequest)return[2];return(u=new FormData).append("file",r[0]),u.append("upload_preset",d.$.upload.PRESET),[4,v().post(d.$.upload.URL,u)];case 1:return i=s.sent().data,l.mutate({accountId:t.id,dto:{name:t.documentRequest.name,url:i.secure_url}},{onSuccess:function(){(0,_.ZP)("Document uploaded successfully"),n.push("/")},onError:function(e){_.ZP.error((0,p.Z)(e))}}),[2]}})}),function(n){return e.apply(this,arguments)}));return(0,i.jsxs)("form",{onSubmit:f,className:"py-20",children:[(0,i.jsx)("input",(0,u.Z)({type:"file"},o.register("file",{required:"Please select document",validate:{size:function(e){if(e[0].size>2097152)return"File too large, max allowed is 2mb"},type:function(e){if(!e[0].type.startsWith("image"))return"Invalid file type"}}}))),o.formState.errors.file&&(0,i.jsx)("p",{className:"text-red-400 py-2",children:o.formState.errors.file.message}),(0,i.jsx)("div",{className:"flex justify-end",children:(0,i.jsx)(a.z,{loading:l.isLoading,children:"Upload"})})]})}},8295:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(9644),u=t.n(r);function s(e){var n,t="Something went wrong";if(!u().isAxiosError(e))return t;var r=null===(n=e.response)||void 0===n?void 0:n.data;return r&&"object"==typeof r&&r.message||t}}},function(e){e.O(0,[949,226,955,385,774,888,179],function(){return e(e.s=7649)}),_N_E=e.O()}]);